var F=Object.defineProperty;var q=(z,t,s)=>t in z?F(z,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):z[t]=s;var x=(z,t,s)=>q(z,typeof t!="symbol"?t+"":t,s);class U{constructor(t){x(this,"G",66743e-15);x(this,"c",299792458);x(this,"earthRadius",1);x(this,"satelliteRadius",6);x(this,"baseSatelliteSpeed",3870);x(this,"realUniverseAge",138e8);x(this,"expansionRate",.005);x(this,"satellites",[]);x(this,"simulationTime",0);x(this,"orbitTime",0);x(this,"expansionFactor",1);x(this,"_isPaused",!1);x(this,"earthRotationAngle",0);x(this,"earthRotationSpeed",.001);x(this,"lastUpdateTime",0);x(this,"accumulator",0);x(this,"fixedTimeStep",1/60);this.satellites=t}get isPaused(){return this._isPaused}setPaused(t){this._isPaused&&!t&&(this.lastUpdateTime=performance.now()),this._isPaused=t}reset(){this.simulationTime=0,this.orbitTime=0,this.expansionFactor=1}update(t,s){if(this._isPaused)return;if(this.lastUpdateTime===0){this.lastUpdateTime=t;return}let i=(t-this.lastUpdateTime)/1e3;for(this.lastUpdateTime=t,this.accumulator+=i;this.accumulator>=this.fixedTimeStep;)this.fixedUpdate(s),this.accumulator-=this.fixedTimeStep}fixedUpdate(t){const i=this.fixedTimeStep*4132.2/1e3;this.simulationTime+=i;const e=this.fixedTimeStep*10/1e3;this.orbitTime+=e,this.expansionFactor+=this.expansionRate*i,this.expansionFactor=Math.min(this.expansionFactor,3);for(let h=0;h<this.satellites.length;h++){const c=h/this.satellites.length*Math.PI*2+this.orbitTime*.5,l=this.satelliteRadius*Math.cos(c),u=this.satelliteRadius*Math.sin(c);this.satellites[h].setPosition(l,0,u);const a=(1+this.calculateDelta(this.satellites[h],t))*i;this.satellites[h].clock+=this.satellites[h].clockRate*a}this.earthRotationAngle+=this.earthRotationSpeed*i}calculateDelta(t,s){const i=t.position.length(),e=-this.G*s/i,h=-this.G*s/this.earthRadius,c=this.baseSatelliteSpeed/1e6;return(e-h)/(this.c*this.c)-c*c/(2*this.c*this.c)}getUniverseAge(){let s=this.simulationTime/300*this.realUniverseAge;return Math.min(s,this.realUniverseAge)}getExpansionFactor(){return this.expansionFactor}getSatellitePositions(){return this.satellites.map(t=>t.position.clone())}getEarthRotation(){return this.earthRotationAngle}setEarthRotationSpeed(t){this.earthRotationSpeed=t}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const P="174";function m(z,t,s){return Math.max(t,Math.min(s,z))}class I{constructor(t=0,s=0,i=0,e=1){this.isQuaternion=!0,this._x=t,this._y=s,this._z=i,this._w=e}static slerpFlat(t,s,i,e,h,c,l){let u=i[e+0],r=i[e+1],a=i[e+2],o=i[e+3];const _=h[c+0],n=h[c+1],y=h[c+2],w=h[c+3];if(l===0){t[s+0]=u,t[s+1]=r,t[s+2]=a,t[s+3]=o;return}if(l===1){t[s+0]=_,t[s+1]=n,t[s+2]=y,t[s+3]=w;return}if(o!==w||u!==_||r!==n||a!==y){let M=1-l;const g=u*_+r*n+a*y+o*w,k=g>=0?1:-1,T=1-g*g;if(T>Number.EPSILON){const d=Math.sqrt(T),E=Math.atan2(d,g*k);M=Math.sin(M*E)/d,l=Math.sin(l*E)/d}const S=l*k;if(u=u*M+_*S,r=r*M+n*S,a=a*M+y*S,o=o*M+w*S,M===1-l){const d=1/Math.sqrt(u*u+r*r+a*a+o*o);u*=d,r*=d,a*=d,o*=d}}t[s]=u,t[s+1]=r,t[s+2]=a,t[s+3]=o}static multiplyQuaternionsFlat(t,s,i,e,h,c){const l=i[e],u=i[e+1],r=i[e+2],a=i[e+3],o=h[c],_=h[c+1],n=h[c+2],y=h[c+3];return t[s]=l*y+a*o+u*n-r*_,t[s+1]=u*y+a*_+r*o-l*n,t[s+2]=r*y+a*n+l*_-u*o,t[s+3]=a*y-l*o-u*_-r*n,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,s,i,e){return this._x=t,this._y=s,this._z=i,this._w=e,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,s=!0){const i=t._x,e=t._y,h=t._z,c=t._order,l=Math.cos,u=Math.sin,r=l(i/2),a=l(e/2),o=l(h/2),_=u(i/2),n=u(e/2),y=u(h/2);switch(c){case"XYZ":this._x=_*a*o+r*n*y,this._y=r*n*o-_*a*y,this._z=r*a*y+_*n*o,this._w=r*a*o-_*n*y;break;case"YXZ":this._x=_*a*o+r*n*y,this._y=r*n*o-_*a*y,this._z=r*a*y-_*n*o,this._w=r*a*o+_*n*y;break;case"ZXY":this._x=_*a*o-r*n*y,this._y=r*n*o+_*a*y,this._z=r*a*y+_*n*o,this._w=r*a*o-_*n*y;break;case"ZYX":this._x=_*a*o-r*n*y,this._y=r*n*o+_*a*y,this._z=r*a*y-_*n*o,this._w=r*a*o+_*n*y;break;case"YZX":this._x=_*a*o+r*n*y,this._y=r*n*o+_*a*y,this._z=r*a*y-_*n*o,this._w=r*a*o-_*n*y;break;case"XZY":this._x=_*a*o-r*n*y,this._y=r*n*o-_*a*y,this._z=r*a*y+_*n*o,this._w=r*a*o+_*n*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return s===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,s){const i=s/2,e=Math.sin(i);return this._x=t.x*e,this._y=t.y*e,this._z=t.z*e,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const s=t.elements,i=s[0],e=s[4],h=s[8],c=s[1],l=s[5],u=s[9],r=s[2],a=s[6],o=s[10],_=i+l+o;if(_>0){const n=.5/Math.sqrt(_+1);this._w=.25/n,this._x=(a-u)*n,this._y=(h-r)*n,this._z=(c-e)*n}else if(i>l&&i>o){const n=2*Math.sqrt(1+i-l-o);this._w=(a-u)/n,this._x=.25*n,this._y=(e+c)/n,this._z=(h+r)/n}else if(l>o){const n=2*Math.sqrt(1+l-i-o);this._w=(h-r)/n,this._x=(e+c)/n,this._y=.25*n,this._z=(u+a)/n}else{const n=2*Math.sqrt(1+o-i-l);this._w=(c-e)/n,this._x=(h+r)/n,this._y=(u+a)/n,this._z=.25*n}return this._onChangeCallback(),this}setFromUnitVectors(t,s){let i=t.dot(s)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*s.z-t.z*s.y,this._y=t.z*s.x-t.x*s.z,this._z=t.x*s.y-t.y*s.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(m(this.dot(t),-1,1)))}rotateTowards(t,s){const i=this.angleTo(t);if(i===0)return this;const e=Math.min(1,s/i);return this.slerp(t,e),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,s){const i=t._x,e=t._y,h=t._z,c=t._w,l=s._x,u=s._y,r=s._z,a=s._w;return this._x=i*a+c*l+e*r-h*u,this._y=e*a+c*u+h*l-i*r,this._z=h*a+c*r+i*u-e*l,this._w=c*a-i*l-e*u-h*r,this._onChangeCallback(),this}slerp(t,s){if(s===0)return this;if(s===1)return this.copy(t);const i=this._x,e=this._y,h=this._z,c=this._w;let l=c*t._w+i*t._x+e*t._y+h*t._z;if(l<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,l=-l):this.copy(t),l>=1)return this._w=c,this._x=i,this._y=e,this._z=h,this;const u=1-l*l;if(u<=Number.EPSILON){const n=1-s;return this._w=n*c+s*this._w,this._x=n*i+s*this._x,this._y=n*e+s*this._y,this._z=n*h+s*this._z,this.normalize(),this}const r=Math.sqrt(u),a=Math.atan2(r,l),o=Math.sin((1-s)*a)/r,_=Math.sin(s*a)/r;return this._w=c*o+this._w*_,this._x=i*o+this._x*_,this._y=e*o+this._y*_,this._z=h*o+this._z*_,this._onChangeCallback(),this}slerpQuaternions(t,s,i){return this.copy(t).slerp(s,i)}random(){const t=2*Math.PI*Math.random(),s=2*Math.PI*Math.random(),i=Math.random(),e=Math.sqrt(1-i),h=Math.sqrt(i);return this.set(e*Math.sin(t),e*Math.cos(t),h*Math.sin(s),h*Math.cos(s))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,s=0){return this._x=t[s],this._y=t[s+1],this._z=t[s+2],this._w=t[s+3],this._onChangeCallback(),this}toArray(t=[],s=0){return t[s]=this._x,t[s+1]=this._y,t[s+2]=this._z,t[s+3]=this._w,t}fromBufferAttribute(t,s){return this._x=t.getX(s),this._y=t.getY(s),this._z=t.getZ(s),this._w=t.getW(s),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class C{constructor(t=0,s=0,i=0){C.prototype.isVector3=!0,this.x=t,this.y=s,this.z=i}set(t,s,i){return i===void 0&&(i=this.z),this.x=t,this.y=s,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,s){switch(t){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this.z=t.z+s.z,this}addScaledVector(t,s){return this.x+=t.x*s,this.y+=t.y*s,this.z+=t.z*s,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,s){return this.x=t.x*s.x,this.y=t.y*s.y,this.z=t.z*s.z,this}applyEuler(t){return this.applyQuaternion(R.setFromEuler(t))}applyAxisAngle(t,s){return this.applyQuaternion(R.setFromAxisAngle(t,s))}applyMatrix3(t){const s=this.x,i=this.y,e=this.z,h=t.elements;return this.x=h[0]*s+h[3]*i+h[6]*e,this.y=h[1]*s+h[4]*i+h[7]*e,this.z=h[2]*s+h[5]*i+h[8]*e,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const s=this.x,i=this.y,e=this.z,h=t.elements,c=1/(h[3]*s+h[7]*i+h[11]*e+h[15]);return this.x=(h[0]*s+h[4]*i+h[8]*e+h[12])*c,this.y=(h[1]*s+h[5]*i+h[9]*e+h[13])*c,this.z=(h[2]*s+h[6]*i+h[10]*e+h[14])*c,this}applyQuaternion(t){const s=this.x,i=this.y,e=this.z,h=t.x,c=t.y,l=t.z,u=t.w,r=2*(c*e-l*i),a=2*(l*s-h*e),o=2*(h*i-c*s);return this.x=s+u*r+c*o-l*a,this.y=i+u*a+l*r-h*o,this.z=e+u*o+h*a-c*r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const s=this.x,i=this.y,e=this.z,h=t.elements;return this.x=h[0]*s+h[4]*i+h[8]*e,this.y=h[1]*s+h[5]*i+h[9]*e,this.z=h[2]*s+h[6]*i+h[10]*e,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,s){return this.x=m(this.x,t.x,s.x),this.y=m(this.y,t.y,s.y),this.z=m(this.z,t.z,s.z),this}clampScalar(t,s){return this.x=m(this.x,t,s),this.y=m(this.y,t,s),this.z=m(this.z,t,s),this}clampLength(t,s){const i=this.length();return this.divideScalar(i||1).multiplyScalar(m(i,t,s))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,s){return this.x+=(t.x-this.x)*s,this.y+=(t.y-this.y)*s,this.z+=(t.z-this.z)*s,this}lerpVectors(t,s,i){return this.x=t.x+(s.x-t.x)*i,this.y=t.y+(s.y-t.y)*i,this.z=t.z+(s.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,s){const i=t.x,e=t.y,h=t.z,c=s.x,l=s.y,u=s.z;return this.x=e*u-h*l,this.y=h*c-i*u,this.z=i*l-e*c,this}projectOnVector(t){const s=t.lengthSq();if(s===0)return this.set(0,0,0);const i=t.dot(this)/s;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return b.copy(this).projectOnVector(t),this.sub(b)}reflect(t){return this.sub(b.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const s=Math.sqrt(this.lengthSq()*t.lengthSq());if(s===0)return Math.PI/2;const i=this.dot(t)/s;return Math.acos(m(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const s=this.x-t.x,i=this.y-t.y,e=this.z-t.z;return s*s+i*i+e*e}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,s,i){const e=Math.sin(s)*t;return this.x=e*Math.sin(i),this.y=Math.cos(s)*t,this.z=e*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,s,i){return this.x=t*Math.sin(s),this.y=i,this.z=t*Math.cos(s),this}setFromMatrixPosition(t){const s=t.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setFromMatrixScale(t){const s=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),e=this.setFromMatrixColumn(t,2).length();return this.x=s,this.y=i,this.z=e,this}setFromMatrixColumn(t,s){return this.fromArray(t.elements,s*4)}setFromMatrix3Column(t,s){return this.fromArray(t.elements,s*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,s=0){return this.x=t[s],this.y=t[s+1],this.z=t[s+2],this}toArray(t=[],s=0){return t[s]=this.x,t[s+1]=this.y,t[s+2]=this.z,t}fromBufferAttribute(t,s){return this.x=t.getX(s),this.y=t.getY(s),this.z=t.getZ(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,s=Math.random()*2-1,i=Math.sqrt(1-s*s);return this.x=i*Math.cos(t),this.y=s,this.z=i*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const b=new C,R=new I;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:P}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=P);class D{constructor(){x(this,"clock");x(this,"clockRate");x(this,"model");x(this,"position");this.clock=0,this.clockRate=1,this.model=null,this.position=new C}setModel(t){this.model=t,this.position=this.model.position}setPosition(t,s,i){this.position.set(t,s,i),this.model&&this.model.position.set(t,s,i)}}let p,A=[];self.onmessage=z=>{const{type:t,payload:s}=z.data;switch(t){case"init":A=s.satellites.map(i=>{const e=new D;return e.position.set(i.position.x,i.position.y,i.position.z),e}),p=new U(A);break;case"update":if(!p)return;p.update(s.timestamp,s.mass),self.postMessage({type:"update",payload:{positions:p.getSatellitePositions(),rotation:p.getEarthRotation(),expansion:p.getExpansionFactor(),universeAge:p.getUniverseAge()}});break;case"pause":p==null||p.setPaused(s.paused);break;case"reset":p==null||p.reset();break}};self.onerror=z=>{console.error("Physics worker error:",z),self.postMessage({type:"error",payload:z})};
